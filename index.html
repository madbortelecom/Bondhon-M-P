<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bondhon - MP Society Ultimate V3 | Managed by Madbor Telecom</title>
    
    <meta name="description" content="‡¶è‡¶Æ ‡¶™‡¶ø ‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø (MP BONDON SOMITI) - ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶≤‡¶æ‡¶≠‡¶ú‡¶®‡¶ï ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶ú‡¶ø‡¶ï ‡¶ì ‡¶Ö‡¶∞‡ßç‡¶•‡¶®‡ßà‡¶§‡¶ø‡¶ï ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡•§">
    <meta name="keywords" content="Bondhon, MP Society, Madbor Telecom, Somiti Management, Digital Savings">
    <meta name="author" content="Madbor Telecom">
    <meta property="og:title" content="Bondhon - MP Society Ultimate V3">
    <meta property="og:description" content="‡¶è‡¶ï‡¶§‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßç‡¶∑‡ßÅ‡¶¶‡ßç‡¶∞ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶ú‡¶ø‡¶ï ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡•§">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Hind Siliguri', sans-serif; 
            background: #020617;
            color: #f1f5f9;
            margin: 0;
            overflow-x: hidden;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 1.5rem;
        }
        .glass-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: #3b82f6;
            outline: none;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
        }
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(12px);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }
        .active-modal { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .btn-gradient {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            transition: transform 0.2s;
        }
        .btn-gradient:active { transform: scale(0.95); }
        .status-badge {
            padding: 4px 10px;
            border-radius: 99px;
            font-size: 10px;
            font-weight: 700;
        }
        .mp-logo-box {
            background: linear-gradient(45deg, #3b82f6, #1e40af);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
        }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
    </style>
</head>
<body class="pb-40">

    <header class="relative pt-10 pb-16 px-6 text-center overflow-hidden">
        <div class="absolute -top-24 left-1/2 -translate-x-1/2 w-96 h-96 bg-blue-600/20 blur-[100px] rounded-full"></div>
        <div class="relative z-10">
            <div class="inline-flex mb-4">
                <div class="mp-logo-box w-16 h-16 flex items-center justify-center rounded-2xl border-2 border-white/20 transform rotate-12">
                    <span class="text-3xl font-black text-white -rotate-12 tracking-tighter">MP</span>
                </div>
            </div>
            <h1 class="text-5xl font-black text-white mb-2 tracking-tighter">BONDHON</h1>
            <p class="text-slate-400 text-xs font-medium tracking-[0.2em] uppercase">Unity & Prosperity Management</p>
            
            <div class="flex justify-center gap-3 mt-8 flex-wrap">
                <button onclick="openM('madborAppsModal')" class="flex flex-col items-center group">
                    <div class="w-14 h-14 glass-card flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300">üöÄ</div>
                    <span class="text-[10px] mt-2 font-bold text-slate-400">Madbor Apps</span>
                </button>
                <button onclick="openM('madborWebsitesModal')" class="flex flex-col items-center group">
                    <div class="w-14 h-14 glass-card flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300">üåê</div>
                    <span class="text-[10px] mt-2 font-bold text-slate-400">Madbor Web</span>
                </button>
                
                <a href="https://chat.whatsapp.com/YOUR_WHATSAPP_GROUP_LINK_HERE" target="_blank" class="flex flex-col items-center group">
                    <div class="w-14 h-14 glass-card border-green-500/30 flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300">üíö</div>
                    <span class="text-[10px] mt-2 font-bold text-slate-400">WhatsApp Group</span>
                </a>

                <button onclick="openM('emergencyContactsModal')" class="flex flex-col items-center group">
                    <div class="w-14 h-14 glass-card border-rose-500/30 flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300">üÜò</div>
                    <span class="text-[10px] mt-2 font-bold text-slate-400">Emergency</span>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 -mt-10 space-y-6 relative z-20">
        
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
            <div class="glass-card p-5 border-l-4 border-l-blue-500">
                <p class="text-[10px] text-slate-500 font-bold uppercase mb-1">‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø</p>
                <h4 id="stat-members" class="text-xl font-black">--</h4>
            </div>
            <div class="glass-card p-5 border-l-4 border-l-emerald-500">
                <p class="text-[10px] text-slate-500 font-bold uppercase mb-1">‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶¶‡¶æ‡¶Ø‡¶º</p>
                <h4 id="stat-total-paid" class="text-xl font-black text-emerald-400">--</h4>
            </div>
            <div class="glass-card p-5 border-l-4 border-l-purple-500">
                <p class="text-[10px] text-slate-500 font-bold uppercase mb-1">‡¶Æ‡ßã‡¶ü ‡¶´‡¶æ‡¶®‡ßç‡¶°</p>
                <h4 id="stat-total-fund" class="text-xl font-black text-purple-400">--</h4>
            </div>
            <div class="glass-card p-5 border-l-4 border-l-rose-500">
                <p class="text-[10px] text-slate-500 font-bold uppercase mb-1">‡¶¨‡¶æ‡¶ï‡¶ø</p>
                <h4 id="stat-total-due" class="text-xl font-black text-rose-400">--</h4>
            </div>
        </div>

        <div class="grid grid-cols-3 md:grid-cols-6 gap-3">
            <button onclick="openM('submissionModal')" class="flex flex-col items-center glass-card p-4 hover:bg-white/10 transition">
                <span class="text-2xl mb-1">üí∞</span>
                <span class="text-[9px] font-bold">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ú‡¶Æ‡¶æ</span>
            </button>
            <button onclick="openM('registerModal')" class="flex flex-col items-center glass-card p-4 hover:bg-white/10 transition">
                <span class="text-2xl mb-1">üìù</span>
                <span class="text-[9px] font-bold">‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®</span>
            </button>
            <button onclick="openM('rulesModal')" class="flex flex-col items-center glass-card p-4 hover:bg-white/10 transition">
                <span class="text-2xl mb-1">‚öñÔ∏è</span>
                <span class="text-[9px] font-bold">‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶æ‡¶¨‡¶≤‡ßÄ</span>
            </button>
            <button onclick="openM('missionModal')" class="flex flex-col items-center glass-card p-4 hover:bg-white/10 transition">
                <span class="text-2xl mb-1">üéØ</span>
                <span class="text-[9px] font-bold">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø</span>
            </button>
            <button onclick="openM('historyModal')" class="flex flex-col items-center glass-card p-4 hover:bg-white/10 transition">
                <span class="text-2xl mb-1 text-blue-400">üìú</span>
                <span class="text-[9px] font-bold">‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</span>
            </button>
            <button onclick="openM('contactModal')" class="flex flex-col items-center glass-card p-4 hover:bg-white/10 transition">
                <span class="text-2xl mb-1">üìû</span>
                <span class="text-[9px] font-bold">‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü</span>
            </button>
        </div>

        <div class="glass-card overflow-hidden border-white/5 shadow-2xl">
            <div class="p-5 bg-white/5 flex justify-between items-center border-b border-white/5">
                <h3 class="font-black text-sm tracking-wide uppercase flex items-center gap-2">
                    <span class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></span>
                    ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
                </h3>
                <span id="sync-status" class="bg-blue-500/10 text-blue-400 text-[9px] px-2 py-1 rounded font-bold uppercase">Connecting...</span>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-black/40 text-[10px] text-slate-500 font-bold uppercase">
                        <tr>
                            <th class="px-6 py-4">‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                            <th class="px-6 py-4">‡¶Æ‡ßã‡¶ü ‡¶ú‡¶Æ‡¶æ</th>
                            <th class="px-6 py-4">‡¶¨‡¶ï‡ßá‡¶Ø‡¶º‡¶æ ‡¶Æ‡¶æ‡¶∏</th>
                            <th class="px-6 py-4 text-right">‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th>
                        </tr>
                    </thead>
                    <tbody id="member-table-body" class="divide-y divide-white/5 text-sm"></tbody>
                </table>
            </div>
            <div id="loader" class="p-10 text-center">
                <div class="inline-block w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
            </div>
        </div>

        <div class="glass-card p-6 text-center space-y-6">
            <div class="flex flex-wrap justify-center items-center gap-4 opacity-80">
                <span class="text-[11px] font-black text-pink-500 bg-pink-500/10 px-3 py-1 rounded-lg">BKASH</span>
                <span class="text-[11px] font-black text-orange-500 bg-orange-500/10 px-3 py-1 rounded-lg">NAGAD</span>
                <span class="text-[11px] font-black text-blue-400 bg-blue-400/10 px-3 py-1 rounded-lg">UPAY</span>
                <span class="text-[11px] font-black text-slate-400 bg-white/5 px-3 py-1 rounded-lg">BANK</span>
            </div>
            
            <div class="pt-4 border-t border-white/5">
                <p class="text-[11px] text-slate-400 font-medium mb-1 uppercase tracking-widest">Powered By</p>
                <h3 class="text-lg font-black text-white tracking-tighter">MADBOR TELECOM</h3>
            </div>
        </div>

        <div class="glass-card p-8 space-y-4">
            <h2 class="text-xl font-black text-blue-400 border-b border-blue-500/20 pb-2">‡¶è‡¶Æ ‡¶™‡¶ø ‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø</h2>
            <div class="text-sm text-slate-400 leading-relaxed space-y-3">
                <p>‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶≤‡¶æ‡¶≠‡¶ú‡¶®‡¶ï ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶ú‡¶ø‡¶ï ‡¶ì ‡¶Ö‡¶∞‡ßç‡¶•‡¶®‡ßà‡¶§‡¶ø‡¶ï ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡•§</p>
                <ul class="list-disc ml-5 space-y-2">
                    <li>‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßá‡¶ï ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡ßá‡¶∞ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡ßá‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡•§</li>
                    <li>‡¶¨‡¶ø‡¶™‡¶¶‡ßá ‡¶Ü‡¶™‡¶¶‡ßá ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡ßá‡¶∞ ‡¶™‡¶æ‡¶∂‡ßá ‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶æ‡¶®‡ßã‡•§</li>
                    <li>‡¶∏‡¶ï‡¶≤ ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶® ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ø‡¶§‡•§</li>
                </ul>
            </div>
        </div>
    </main>

    <footer class="max-w-4xl mx-auto px-4 py-8 text-center text-slate-500 text-xs space-y-4 relative z-20 mb-20">
        <div class="flex justify-center gap-4 font-bold uppercase tracking-wider">
            <button onclick="openM('aboutUsModal')" class="hover:text-blue-400 transition">About Us</button>
            <span>|</span>
            <button onclick="openM('teamsModal')" class="hover:text-blue-400 transition">Teams</button>
            <span>|</span>
            <button onclick="openM('privacyModal')" class="hover:text-blue-400 transition">Privacy Policy</button>
        </div>
        <p>¬© 2024 Bondhon MP Society. All rights reserved. | Managed by Madbor Telecom</p>
    </footer>

    <div id="submissionModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('submissionModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-6 text-center text-blue-400">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</h3>
            <form id="paymentForm" class="space-y-4">
                <select id="payMember" class="glass-input w-full p-4 rounded-xl" required></select>
                <input type="number" id="payAmount" required placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß´‡ß¶‡ß¶/‡ßß‡ß¶‡ß¶‡ß¶)" class="glass-input w-full p-4 rounded-xl">
                <input type="text" id="payTx" required placeholder="Transaction ID (TrxID)" class="glass-input w-full p-4 rounded-xl uppercase">
                <button type="submit" class="w-full btn-gradient py-4 rounded-xl font-black text-white shadow-lg">‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü</button>
            </form>
        </div>
    </div>

    <div id="registerModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('registerModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-6 text-center text-blue-400">‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®</h3>
            <form id="regForm" class="space-y-4">
                <input type="text" id="regName" required placeholder="‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡ßá‡¶∞ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ" class="glass-input w-full p-4 rounded-xl">
                <input type="tel" id="regPhone" required placeholder="‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡ßá‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" class="glass-input w-full p-4 rounded-xl">
                <select id="regPlan" class="glass-input w-full p-4 rounded-xl">
                    <option value="500">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</option>
                    <option value="1000">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</option>
                </select>
                <button type="submit" class="w-full btn-gradient py-4 rounded-xl font-black text-white shadow-lg">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </form>
        </div>
    </div>

    <div id="historyModal" class="modal-overlay">
        <div class="max-w-md mx-auto mt-10 glass-card p-6 relative">
            <button onclick="closeM('historyModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4 text-center text-blue-400">‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®‡ßá‡¶∞ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏</h3>
            <div id="history-container" class="space-y-3 max-h-[60vh] overflow-y-auto pr-2">
                <p class="text-center text-slate-500 text-xs">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</p>
            </div>
        </div>
    </div>

    <div id="rulesModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('rulesModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4 text-blue-400">‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶æ‡¶¨‡¶≤‡ßÄ</h3>
            <div class="text-xs space-y-2 text-slate-300">
                <p>‡ßß. ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡ßß‡ß¶ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§</p>
                <p>‡ß®. ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßá ‡¶ã‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá (‡¶∂‡¶∞‡ßç‡¶§‡¶∏‡¶æ‡¶™‡ßá‡¶ï‡ßç‡¶∑‡ßá)‡•§</p>
                <p>‡ß©. ‡ß© ‡¶Æ‡¶æ‡¶∏ ‡¶ü‡¶æ‡¶®‡¶æ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶®‡¶æ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶™‡¶¶ ‡¶∏‡ßç‡¶•‡¶ó‡¶ø‡¶§ ‡¶π‡¶¨‡ßá‡•§</p>
            </div>
        </div>
    </div>

    <div id="missionModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('missionModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4 text-blue-400">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø</h3>
            <p class="text-xs text-slate-300">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶π‡¶≤‡ßã ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶¨‡¶≤‡¶Æ‡ßç‡¶¨‡ßÄ ‡¶ï‡¶∞‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶ú‡¶ø‡¶ï ‡¶≠‡ßç‡¶∞‡¶æ‡¶§‡ßÉ‡¶§‡ßç‡¶¨ ‡¶¨‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶ñ‡¶æ‡•§</p>
        </div>
    </div>

    <div id="madborAppsModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('madborAppsModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4">Madbor Apps</h3>
            <p class="text-xs text-slate-300">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶ú‡¶æ‡¶®‡¶§‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
        </div>
    </div>

    <div id="madborWebsitesModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('madborWebsitesModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4">Madbor Web</h3>
            <p class="text-xs text-slate-300">‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨ ‡¶∏‡¶≤‡ßç‡¶Ø‡ßÅ‡¶∂‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶ø‡•§</p>
        </div>
    </div>

    <div id="emergencyContactsModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('emergencyContactsModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-6 text-center text-rose-500">‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü</h3>
            <div class="space-y-4 text-sm">
                <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                    <p class="font-bold">‡¶π‡ßá‡¶≤‡ßç‡¶™‡¶≤‡¶æ‡¶á‡¶®</p>
                    <p class="text-slate-400">+‡ßÆ‡ßÆ‡ß¶ ‡ßß‡ß≠‡ßß‡ß®-‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ</p>
                </div>
                <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                    <p class="font-bold">‡¶ü‡ßá‡¶ï‡¶®‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</p>
                    <p class="text-slate-400">+‡ßÆ‡ßÆ‡ß¶ ‡ßß‡ß≠‡ß´‡ß™-‡ß©‡ß¨‡ßß‡ß™‡ßØ‡ß¶</p>
                </div>
            </div>
        </div>
    </div>

    <div id="contactModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('contactModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-6 text-center">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h3>
            <div class="space-y-4 text-center">
                <p class="text-slate-400 text-sm">‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶∏‡¶æ ‡¶¨‡¶æ ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                <div class="flex justify-center gap-4">
                    <a href="tel:01754361490" class="w-12 h-12 glass-card flex items-center justify-center">üìû</a>
                    <a href="https://wa.me/8801754361490" target="_blank" class="w-12 h-12 glass-card flex items-center justify-center">üí¨</a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="aboutUsModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('aboutUsModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4 text-blue-400">About Us</h3>
            <p class="text-xs text-slate-300 leading-relaxed">‡¶è‡¶Æ ‡¶™‡¶ø ‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶Ø‡¶æ ‡¶∏‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶§‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßç‡¶∑‡ßÅ‡¶¶‡ßç‡¶∞ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶Ö‡¶∞‡ßç‡¶•‡¶®‡ßà‡¶§‡¶ø‡¶ï ‡¶∏‡¶Æ‡ßÉ‡¶¶‡ßç‡¶ß‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶ø ‡¶∏‡ßç‡¶¨‡¶ö‡ßç‡¶õ‡¶§‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶π‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ‡¶á ‡¶â‡¶®‡ßç‡¶®‡¶§‡¶ø‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶ö‡¶æ‡¶¨‡¶ø‡¶ï‡¶æ‡¶†‡¶ø‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶π‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶ï‡ßá ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶¨‡¶≤‡¶Æ‡ßç‡¶¨‡ßÄ ‡¶ï‡¶∞‡ßá ‡¶§‡ßã‡¶≤‡¶æ‡•§</p>
        </div>
    </div>

    <div id="teamsModal" class="modal-overlay">
        <div class="max-w-sm mx-auto mt-20 glass-card p-8 relative">
            <button onclick="closeM('teamsModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-6 text-center">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡¶ø‡¶Æ</h3>
            <div class="space-y-4">
                    <div class="flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5">
                    <div class="w-10 h-10 bg-blue-500/20 rounded-full flex items-center justify-center text-xl">üë®‚Äçüíº</div>
                    <div>
                        <h4 class="font-bold text-sm text-white">‡¶∏‡¶≠‡¶æ‡¶™‡¶§‡¶ø</h4>
                        <p class="text-xs text-slate-400">‡¶®‡¶æ‡¶Æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶∏‡¶¨‡ßá</p>
                    </div>
                </div>
                    <div class="flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5">
                    <div class="w-10 h-10 bg-emerald-500/20 rounded-full flex items-center justify-center text-xl">üë®‚Äç‚öñÔ∏è</div>
                    <div>
                        <h4 class="font-bold text-sm text-white">‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶ï</h4>
                        <p class="text-xs text-slate-400">‡¶®‡¶æ‡¶Æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶∏‡¶¨‡ßá</p>
                    </div>
                </div>
                    <div class="flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5">
                    <div class="w-10 h-10 bg-purple-500/20 rounded-full flex items-center justify-center text-xl">üë®‚Äçüíª</div>
                    <div>
                        <h4 class="font-bold text-sm text-white">‡¶ï‡¶æ‡¶∞‡¶ø‡¶ó‡¶∞‡¶ø ‡¶∏‡¶π‡¶æ‡ßü‡¶§‡¶æ (IT)</h4>
                        <p class="text-xs text-slate-400">‡¶Æ‡¶æ‡¶¶‡¶¨‡¶∞ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ï‡¶Æ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="privacyModal" class="modal-overlay">
        <div class="max-w-md mx-auto mt-10 glass-card p-6 relative max-h-[80vh] overflow-y-auto">
            <button onclick="closeM('privacyModal')" class="absolute top-4 right-4 text-xl">&times;</button>
            <h3 class="text-xl font-black mb-4 text-blue-400 sticky top-0">Privacy Policy</h3>
            
            <div class="text-xs text-slate-300 leading-relaxed space-y-4">
                <p class="text-slate-500">Last updated: December 10, 2025</p>
                <p>This Privacy Policy describes Our policies and procedures on the collection, use and disclosure of Your information when You use the Service and tells You about Your privacy rights and how the law protects You.</p>
                <p>We use Your Personal data to provide and improve the Service. By using the Service, You agree to the collection and use of information in accordance with this Privacy Policy.</p>
                
                <h4 class="text-base font-bold text-white mt-6 mb-2">Interpretation and Definitions</h4>
                <p>The words whose initial letters are capitalized have meanings defined under the following conditions. The following definitions shall have the same meaning regardless of whether they appear in singular or in plural.</p>
                <ul class="list-disc ml-4 space-y-2 mt-2">
                    <li><strong>Account:</strong> A unique account created for You to access our Service.</li>
                    <li><strong>Company:</strong> (referred to as either "the Company", "We", "Us" or "Our" in this Agreement) refers to **Bondhon MP Society (Managed by Madbor Telecom)**.</li>
                    <li><strong>Country:</strong> Bangladesh.</li>
                    <li><strong>Personal Data:</strong> Any information that relates to an identified or identifiable individual.</li>
                    <li><strong>Service:</strong> Refers to this Application/Website.</li>
                    <li><strong>Service Provider:</strong> Third-party companies (like Google Firebase) employed by the Company to facilitate the Service.</li>
                    <li><strong>You:</strong> The individual accessing or using the Service.</li>
                </ul>

                <h4 class="text-base font-bold text-white mt-6 mb-2">Collecting and Using Your Personal Data</h4>
                <p>While using Our Service, We may ask You to provide Us with certain personally identifiable information, including:</p>
                <ul class="list-disc ml-4 space-y-1 mt-2">
                    <li>Phone number</li>
                    <li>First name and last name</li>
                    <li>Transaction details (for savings management)</li>
                </ul>

                <h4 class="text-base font-bold text-white mt-6 mb-2">Use of Your Personal Data</h4>
                <p>The Company may use Personal Data for the following purposes:</p>
                <ul class="list-disc ml-4 space-y-1 mt-2">
                    <li>To provide and maintain our Service.</li>
                    <li>To manage Your Account and registration.</li>
                    <li>To contact You regarding updates or informative communications related to the functionalities.</li>
                </ul>

                <h4 class="text-base font-bold text-white mt-6 mb-2">Security of Your Personal Data</h4>
                <p>The security of Your Personal Data is important to Us. Your data is stored securely using Google Firebase services. While We strive to use commercially reasonable means to protect Your Personal Data, We cannot guarantee its absolute security.</p>

                <h4 class="text-base font-bold text-white mt-6 mb-2">Changes to this Privacy Policy</h4>
                <p>We may update Our Privacy Policy from time to time. We will notify You of any changes by posting the new Privacy Policy on this page.</p>

                <h4 class="text-base font-bold text-white mt-6 mb-2">Contact Us</h4>
                <p>If you have any questions about this Privacy Policy, You can contact us:</p>
                <ul class="list-disc ml-4 space-y-1 mt-2">
                    <li>By phone: 01754361490</li>
                    <li>By email: sksakibvai990@gmail.com</li>
                    <li>Address: Shibchar, Madaripur, Dhaka, Bangladesh.</li>
                </ul>
            </div>
        </div>
    </div>

    <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] max-w-md glass-card bg-black/60 border-white/20 px-8 py-4 flex justify-between items-center z-50 shadow-[0_0_50px_rgba(0,0,0,0.5)]">
        <button onclick="location.reload()" class="text-blue-400 flex flex-col items-center">
            <span class="text-xl">üè†</span>
            <span class="text-[9px] font-bold uppercase mt-1">‡¶π‡ßã‡¶Æ</span>
        </button>
        <button onclick="openM('submissionModal')" class="text-slate-500 flex flex-col items-center">
            <span class="text-xl">üí≥</span>
            <span class="text-[9px] font-bold uppercase mt-1">‡¶ú‡¶Æ‡¶æ</span>
        </button>
        <button onclick="openM('historyModal')" class="text-slate-500 flex flex-col items-center">
            <span class="text-xl">üìú</span>
            <span class="text-[9px] font-bold uppercase mt-1">‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø</span>
        </button>
        <button onclick="openM('contactModal')" class="text-slate-500 flex flex-col items-center">
            <span class="text-xl">üìû</span>
            <span class="text-[9px] font-bold uppercase mt-1">‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</span>
        </button>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, doc, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // TODO: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ‡¶Ö‡¶¨‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶¨‡¶∏‡¶æ‡¶®
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // App ID for Firestore path (Unique identifier for this society version)
        const appId = 'bondhon-mp-society-v3'; 

        // Global variables to hold data
        let members = [];
        let payments = [];

        // Modal Control Functions (Global Scope)
        window.openM = (id) => {
            document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active-modal'));
            const modal = document.getElementById(id);
            if(modal) modal.classList.add('active-modal');
        }
        window.closeM = (id) => {
            const modal = document.getElementById(id);
            if(modal) modal.classList.remove('active-modal');
        }

        // Authentication setup
        const initAuth = async () => {
            try {
                // Check for custom token if available in global scope
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    // Otherwise, sign in anonymously
                    await signInAnonymously(auth);
                }
            } catch (err) {
                console.error("Auth Error:", err);
                document.getElementById('sync-status').innerText = 'Auth Failed';
                document.getElementById('sync-status').classList.replace('text-blue-400', 'text-rose-400');
            }
        };
        initAuth();

        // Auth state listener to start syncing data
        onAuthStateChanged(auth, user => {
            if(user) {
                document.getElementById('sync-status').innerText = 'Online';
                startSync();
            }
        });

        // Real-time Data Sync Function
        function startSync() {
            // Sync Members
            onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'members'), snap => {
                members = snap.docs.map(d => ({id: d.id, ...d.data()}));
                render();
            });
            
            // Sync Payments (Ordered by date descending)
            const paymentsQuery = query(collection(db, 'artifacts', appId, 'public', 'data', 'payments'), orderBy('date', 'desc'));
            onSnapshot(paymentsQuery, snap => {
                payments = snap.docs.map(d => d.data());
                render();
            });
        }

        // Registration Form Submission Handler
        document.getElementById('regForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = e.submitter;
            btn.disabled = true;
            btn.innerHTML = '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...';
            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'members'), {
                    name: document.getElementById('regName').value,
                    phone: document.getElementById('regPhone').value,
                    plan: parseInt(document.getElementById('regPlan').value),
                    joinDate: Date.now(),
                    uid: auth.currentUser.uid
                });
                closeM('registerModal');
                e.target.reset();
                alert('‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            } catch (err) { 
                console.error(err);
                alert('‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            }
            btn.disabled = false;
            btn.innerHTML = '‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®';
        };

        // Payment Submission Form Handler
        document.getElementById('paymentForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = e.submitter;
            const memberPhone = document.getElementById('payMember').value;
            
            if(!memberPhone) {
                alert('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ú‡¶® ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç...';
            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'payments'), {
                    phone: memberPhone,
                    amount: parseFloat(document.getElementById('payAmount').value),
                    txid: document.getElementById('payTx').value.toUpperCase().trim(),
                    date: Date.now(),
                    timestamp: serverTimestamp()
                });
                closeM('submissionModal');
                e.target.reset();
                alert('‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            } catch (err) { 
                console.error(err);
                alert('‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§');
            }
            btn.disabled = false;
            btn.innerHTML = '‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü';
        };

        // Main Render Function (Updates UI based on data)
        function render() {
            document.getElementById('loader')?.classList.add('hidden');
            const tbody = document.getElementById('member-table-body');
            const select = document.getElementById('payMember');
            const historyBox = document.getElementById('history-container');
            
            let tColl = 0, tDue = 0, tFund = 0;
            const currentSel = select.value;
            select.innerHTML = '<option value="">‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</option>';

            // 1. Render Member Table & Populate Select Dropdown
            if (members.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="text-center py-4 text-slate-500">‡¶ï‡ßã‡¶® ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶®‡ßá‡¶á</td></tr>';
            } else {
                tbody.innerHTML = members.map(m => {
                    // Calculate financials for each member
                    const paid = payments.filter(p => p.phone === m.phone).reduce((s, p) => s + (p.amount || 0), 0);
                    const joinTime = m.joinDate || Date.now();
                    // Approximate months elapsed since joining (30.44 days average month)
                    const monthsElapsed = Math.max(1, Math.ceil((Date.now() - joinTime) / (1000*60*60*24*30.44)));
                    const monthlyPlan = m.plan || 500;
                    const targetAmount = monthsElapsed * monthlyPlan;
                    const dueAmount = targetAmount - paid;
                    const dueMonthsCount = Math.max(0, Math.ceil(dueAmount / monthlyPlan));
                    
                    // Update aggregate stats
                    tColl += paid; 
                    tFund += targetAmount; 
                    if(dueAmount > 0) tDue += dueAmount;

                    // Populate payment select option
                    const opt = document.createElement('option');
                    opt.value = m.phone; 
                    opt.text = `${m.name} (${m.phone})`;
                    opt.classList.add('text-black'); // Ensure dropdown options are visible
                    if(m.phone === currentSel) opt.selected = true;
                    select.add(opt);

                    // Generate table row HTML
                    return `
                        <tr class="hover:bg-white/5 transition border-b border-white/5">
                            <td class="px-6 py-5">
                                <div class="font-bold text-white">${m.name}</div>
                                <div class="text-[9px] text-slate-500 font-medium">${m.phone}</div>
                            </td>
                            <td class="px-6 py-5">
                                <div class="font-black text-emerald-400">‡ß≥${paid.toLocaleString('bn-BD')}</div>
                            </td>
                            <td class="px-6 py-5">
                                <div class="text-[11px] font-bold ${dueMonthsCount > 0 ? 'text-rose-400' : 'text-slate-500'}">
                                    ${dueMonthsCount > 0 ? dueMonthsCount.toLocaleString('bn-BD') + ' ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø' : '‡¶¨‡¶ï‡ßá‡¶Ø‡¶º‡¶æ ‡¶®‡ßá‡¶á'}
                                </div>
                            </td>
                            <td class="px-6 py-5 text-right">
                                <span class="status-badge ${dueAmount <= 0 ? 'bg-emerald-500/10 text-emerald-500' : 'bg-rose-500/10 text-rose-500'}">
                                    ${dueAmount <= 0 ? '‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡¶ø‡¶§' : '‡¶¨‡¶æ‡¶ï‡¶ø ‡ß≥' + dueAmount.toLocaleString('bn-BD')}
                                </span>
                            </td>
                        </tr>`;
                }).join('');
            }

            // 2. Render History
            historyBox.innerHTML = payments.length > 0 ? payments.map(p => {
                const mName = members.find(m => m.phone === p.phone)?.name || 'Unknown Member';
                return `
                    <div class="p-4 bg-white/5 rounded-xl border border-white/5 flex justify-between items-center transition hover:bg-white/10">
                        <div>
                            <p class="text-xs font-bold text-white">${mName}</p>
                            <p class="text-[9px] text-slate-500">Trx: ${p.txid || 'N/A'}</p>
                            <p class="text-[8px] text-blue-400">${p.date ? new Date(p.date).toLocaleString('bn-BD') : ''}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-emerald-400 font-black">‡ß≥${(p.amount || 0).toLocaleString('bn-BD')}</p>
                            <p class="text-[8px] bg-emerald-500/10 text-emerald-500 px-2 rounded-full inline-block">Success</p>
                        </div>
                    </div>`;
            }).join('') : '<p class="text-center text-slate-500 text-xs py-4">‡¶ï‡ßã‡¶®‡ßã ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</p>';

            // 3. Update Quick Stats
            document.getElementById('stat-members').innerText = members.length.toLocaleString('bn-BD');
            document.getElementById('stat-total-paid').innerText = '‡ß≥' + tColl.toLocaleString('bn-BD');
            // Total Fund is what *should* have been collected, or you might want to show current balance (tColl). 
            // Using tFund as "Target Fund" based on your previous logic.
            document.getElementById('stat-total-fund').innerText = '‡ß≥' + tFund.toLocaleString('bn-BD');
            document.getElementById('stat-total-due').innerText = '‡ß≥' + tDue.toLocaleString('bn-BD');
        }
    </script>
</body>
</html>
